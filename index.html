<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="description" content="GeoNarrative Template" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>GeoNarrative Template</title>
  <!-- <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,400;0,500;1,400;1,500&display=swap" /> -->
  <!-- <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/v2.8.1/mapbox-gl.css"> -->
  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css"> -->
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/customized.css">
  <script src="https://unpkg.com/scrollama"></script>
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.8.1/mapbox-gl.js"></script>
</head>

<body>
  
  <!-- loading a image as the background of the cover page -->
  <section id="cover" style="background: url('img/cover-trail.jpg') no-repeat center center;  background-size: cover;">
    <div id="intro">
      <h1>Klondike Gold Rush</h1>
      <!-- <h5>This line is a place holder for subtitle</h5> -->
      <p>
  This storymap explores the Klondike Gold Rush and its impact on the Pacific Northwest, tracing the journey of thousands of gold-seekers from Seattle through rugged terrain to the goldfields of the Yukon. Using maps, images, and historical context, it highlights the key locations and challenges faced by prospectors during one of the most influential events in Seattle history.
</p>

      <div class="footnote">
        <span> This storymap is made by William Zhang. The lastest update is May 16, 2025</span>
        <!-- <a target="_blank" href="https://www.uw.edu"> <img src="img/uw_logo.png" width="50px"></a> -->
      </div>
    </div>
  </section>
  <!-- a geonarrative will have two major components, a storyboard and a script panel of a series of scenes/actions -->
  <section id="geonarrative">
    <!-- a storymap can present differnt types of objects, like map, chart, diagram, etc. -->
    <div id="storyboard">
      <!-- create the place holder element for map -->
      <div id="map"></div>
    </div>

    <article class="scene" data-scene="0">
      <h2>Seattle</h2>
      <p>The klondike gold rush is what lead to Seattle growing into a major city. It was a
        massive migration
        of an estimated 100,000 prospectors to the Klondike region of the Yukon in north-western Canada between 1896 and
        1899, being one of the biggest gold rushes in north America. 
        The rush was mainly started when the steamship Oregon arrived in Seattle, carrying 11.2 tons of gold, along with a wave of enthusiasm
        for the plentiful gold fields in the Klondike. This enthusiasm started spreading worldwide, causing most of the prospectors to come flooding
        through Seattle to start their journey to the Klondike.
        </p>
      <img src="img/news.jpg"></img>
    </article>
    <article class="scene" data-scene="1">
      <h2>Loading Points</h2>
      <p>
        Skagway, Alaska, was one of the main gateways to the Klondike during the gold rush of the late 1890s. This small
        port town became a bustling hub for stampeders arriving by ship, all seeking to begin their treacherous journey
        inland. From Skagway, many prospectors faced the grueling climb over the Chilkoot or White Pass trails, hauling
        a year’s worth of supplies through dangerous terrain. The town’s rapid growth, lawlessness, and colorful
        characters made it both a place of opportunity and hardship. Today, Skagway stands as a preserved reminder of
        the gold rush era and the incredible human ambition that fueled it.
      </p>
      <img src="img/skagway.jpg"></img>
    </article>
    <article class="scene" data-scene="2">
      <h2>Lake Bennett</h2>
      <p>
        Lake Bennett, nestled between British Columbia and the Yukon Territory in northwestern Canada, played a pivotal role during the Klondike Gold Rush. Situated at an elevation of 656 meters (2,152 feet), the lake spans approximately 41 kilometers in length and reaches depths of up to 123 meters. During the gold rush, stampeders traversed arduous routes Lake Bennett. Here, they constructed or purchased boats to navigate the Yukon River toward the goldfields near Dawson City. In May 1898 alone, the North-West Mounted Police recorded nearly 1,000 boats on Lake Bennett, with an estimated 7,000 boats built in the area to transport approximately 30,000 men and women. A bustling tent city emerged along the lake's shores, offering services ranging from supply stores to saloons. 
      </p>
      <img src="img/bennett.jpg"></img>
    </article>
    <article class="scene" data-scene="3">
      <h2>Alternate routes</h2>
      <p>
        Of course, there were many alternate routes. For example, the "rich man's route", or "All-water route", where you would get sailed
        to the Alaksan town of St Michael and sail up the Yukon river all the way up the Klondike. It mainly got its name from the fact that it was
        much more expensive than the other routes.
        Of course, all the alternate routes had some kind of issue that prevented many people traversing them. For the All-water route, it was the fact that 
        the Yukon river would freeze for most of the year due to its far northern position. There was also an All-land route starting from Edmonton, but that also
        didn't work due to being it logistically impossible, incredibly long and arduous, and taking so long that by the time people got there most of the enthusiasm was gone
    </article>
    <article class="scene" data-scene="4">
      <h2>Dawson City</h2>
      <p>
        Dawson City was the ultimate destination for thousands of gold-seekers during the Klondike Gold Rush. Located at
        the confluence of the Klondike and Yukon rivers in Canada’s Yukon Territory, the city rapidly transformed from a
        remote outpost into a booming town nearly overnight. At its peak, Dawson City was home to over 30,000 people and
        served as the center of the gold rush economy. Although only a small fraction of prospectors actually found
        gold, the journey to Dawson and the town’s bustling atmosphere left a lasting legacy in the history of North
        American exploration and settlement.
      </p>
      <hr>
      <div>
        <!-- loading bootstrap icons -->
        <p><i class="bi bi-person"></i> <span>~30,000</span>
        </p>
      </div>
    </article>
    <article class="scene" data-scene="5">
      <h2>results? </h2>
      <p>
        though over a hundred thousand people traveled, or at least attempted to travel to the Klondike for gold, only a 300-400 of them
        ever struck it rich, and of these, only a few actually kept their wealth.
        No, the most impactful aspect of the Klondike wasn't the gold itself, it was the money and population Seattle gained from all the people 
        passing through and settling, and the recognition they brought along with them. 
      </p>
      <article class="scene" data-scene="7">


      </article>
    </article>
    <article class="scene fullscreen" data-scene="6">
      <h2></h2>
    </article>

  </section>

  <section id="footer">
    <h2>FOOTER</h2>
  </section>


  <script>
    // 1. Declare the maps, script panels, and different thematic layers.
    let map, scriptPanel = scrollama(), countiesLayer, cellTowersLayer;
    const seattle = [-122.33228030560824, 47.60580259714015];
    const skagway = [-135.3145, 59.4572];
    const bennett = [-134.8805, 60.0799];
    const yukon = [-162.499323, 63.193946];

    // 2. Intialize the layout.

    history.scrollRestoration = "manual"; // make sure the geo-narrative will be scrolled to the cover page even after a page refresh.
    window.scrollTo(0, 0); // scroll the geo-narrative to the coverpage
    adjustStoryboardlSize(); // force a browser window resize.
    window.addEventListener("resize", adjustStoryboardlSize); // // ask the browser window listen to the resize event, thereby force a viewport resize whenever adjusting the window size.

    // 3. Define Generic window resize listener event
    function adjustStoryboardlSize() {

      const scenes = document.getElementsByClassName("scene");
      const storyboard = document.getElementById("storyboard");

      // 3.1 determine the height of each scene element
      let sceneH = Math.floor(window.innerHeight * 1.25);
      for (const scene of scenes) {
        scene.style.height = sceneH + "px";
      }

      // 3.2 determin the height of the storyboard.
      let storyboardHeight = window.innerHeight;
      let storyboardMarginTop = (window.innerHeight - storyboardHeight) / 2;

      storyboard.style.height = storyboardHeight + "px";
      storyboard.style.top = storyboardMarginTop + "px"

      // 3.3 tell scrollama/script panel to update new element dimensions
      scriptPanel.resize();
    }
    // 4. Initialize the mapbox
    mapboxgl.accessToken =
      'pk.eyJ1IjoiamFrb2J6aGFvIiwiYSI6ImNpcms2YWsyMzAwMmtmbG5icTFxZ3ZkdncifQ.P9MBej1xacybKcDN_jehvw'; // Assign the access token

    map = new mapboxgl.Map({
      container: 'map', // container ID
      // style: 'mapbox://styles/mapbox/light-v10',
      style: 'mapbox://styles/mapbox/satellite-streets-v10', // style URL
      zoom: 11, // starting zoom
      minZoom: 3,
      maxZoom: 14,
      center: seattle, // starting center
      scrollZoom: false,
      boxZoom: false,
      doubleClickZoom: false
    });  // Declare the map object

    // An alternative way to disable map zoom when using scroll
    // map.scrollZoom.disable();


    // 5. define the asynchronous function to load geojson data and then performs the dependent actions.
    async function geojsonFetch() {

      // 6 wait till the data of washington counties and celltowers are fully loaded.
      let response, counties, celltowers;
      response = await fetch("assets/trail.geojson");
      trail = await response.json(); response = await fetch("assets/celltowers.geojson");
      celltowers = await response.json();


      // 7. Trigger operations inside of the the ()=> {} funciton while loading the map.
      map.on('load', () => {

        // 8. add map source and declare layers.
        map.addSource('celltowers-src', {
          type: 'geojson',
          data: celltowers
        });

        map.addSource('trail-src', {
          type: 'geojson',
          data: trail
        });

        trailLayer = {
          'id': 'trail-lines',
          'type': 'line',
          'source': 'trail-src',
          'minzoom': 5,
          'layout': {
            'line-join': 'round',
            'line-cap': 'round'
          },
          'paint': {
            'line-color': '#888',
            'line-width': 8
          }
        };
        map.setStyle('mapbox://styles/mapbox/light-v10');

        cellTowersLayer = {
          'id': 'celltowers-points',
          'type': 'circle',
          'source': 'celltowers-src',
          'minzoom': 5,
          'paint': {
            'circle-color': 'red',
            'circle-radius': 4,
            'circle-opacity': 0.8,
          }
        };

        // 9. Initialize the script panel
        scriptPanel
          .setup({
            step: ".scene", // all the scenes.
            offset: 0.33, // the location of the enter and exit trigger
            debug: false // toggler on or off the debug mode.
          })
          .onStepEnter(handleSceneEnter)
          .onStepExit(handleSceneExit);

        // 10. This function performs when a scene enters the storyboard
        function handleSceneEnter(response) {

          var index = response.index; // capture the id of the current scene. 

          if (index === 0) { // When enter the first scene

            // [-135.3145, 59.4572],

            map.flyTo({
              center: seattle,
              zoom: 11,
              pitch: 0,
              speed: 0.5
            }); // fly to a new location

            if (typeof (map.getSource('trail-src')) == 'undefined') { //if the map source 'counties-src' does not exist
              map.addSource('trail-src', {
                type: 'geojson',
                data: trail
              }); // reload the map source of 'counties-src'
            } else {
              map.getSource('trail-src').setData(trail); // if the map source does not exist, relaod the data counties to the pre-defined map source 'counties-src'.

            }

            if (!map.getLayer("trail-lines")) { // if the map layer 'counties-polygons' does not exit
              map.addLayer(trailLayer);
            }
            document.getElementById("cover").style.visibility = "hidden"; // Hide the cover page

          } else if (index === 1) { // When enter the second scene.
            map.flyTo({
              center: skagway,
              zoom: 10,
              pitch: 60,
              speed: 1

            });



            // if (typeof (map.getSource('celltowers-src')) == 'undefined') {
            //   map.addSource('celltowers-src', {
            //     type: 'geojson',
            //     data: celltowers
            //   });
            // } else {
            //   map.getSource('celltowers-src').setData(celltowers);

            // }

            // if (!map.getLayer("celltowers-points")) {
            //   map.addLayer(cellTowersLayer);
            // }
          } else if (index === 2) {
            //Relocate to lake bennett
            map.flyTo({
              center: bennett,
              zoom: 12,
              pitch: 0,
              speed: 0.5

            });

          } else if (index === 3) {
            //Relocate to yukon delta
            map.flyTo({
              center: yukon,
              zoom: 7,
              pitch: 60,
              speed: 1

            });

            map.setStyle('mapbox://styles/mapbox/satellite-streets-v10'); // change the base map
          } else if (index === 4) {

            map.flyTo({
              center: [-139.4333, 64.0639],
              zoom: 10,
              pitch: 0,
              speed: 1

            });
          } else if (index === 5) {

            map.flyTo({
              center: [-122.3328,47.6061],
              zoom: 10,
              pitch: 0,
              speed: 1

            });


          }
          // -122.33228030560824, 47.60580259714015

        }

        // 11. This function performs when a scene exists the storyboard
        function handleSceneExit(response) {
          var index = response.index;

          if (index === 0) {
            // if (map.getLayer("counties-polygons")) {
            //   map.removeLayer('counties-polygons');
            // }
            if (response.direction == 'down') {
              document.getElementById("cover").style.visibility = "hidden"; // when you scroll down, the cover page will be hided.
            } else {
              document.getElementById("cover").style.visibility = "visible"; // when you scroll up, the cover page will be shown.
            }
          } else if (index === 1) {
            // if (map.getLayer("celltowers-points")) {
            //   map.removeLayer('celltowers-points');
            // }
          } else if (index === 3) {
            //exit to Portland
            map.setStyle('mapbox://styles/mapbox/light-v10');
          }
        }


      });

    };

    // 5 call the data loading function.
    geojsonFetch();
  </script>
</body>

</html>
